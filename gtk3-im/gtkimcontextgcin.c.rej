--- gtk3-im/gtkimcontextgcin.c
+++ gtk3-im/gtkimcontextgcin.c
@@ -125,11 +123,13 @@
 static void
 get_im (GtkIMContextGCIN *context_xim)
 {
+#if 0
   GdkWindow *client_window = context_xim->client_window;
   GdkScreen *screen = gdk_drawable_get_screen (client_window);
   GdkDisplay *display = gdk_screen_get_display (screen);
+#endif
   if (!context_xim->gcin_ch) {
-    if (!(context_xim->gcin_ch = gcin_im_client_open(GDK_DISPLAY())))
+    if (!(context_xim->gcin_ch = gcin_im_client_open(GDK_DISPLAY_XDISPLAY(gdk_display_get_default()))))
       perror("cannot open gcin_ch");
 #if 1
     context_xim->timeout_handle = 0;
